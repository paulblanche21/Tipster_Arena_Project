{% extends "base.html" %}

{% block content %}

<main>
    <div class="container mt-5">
        <h2>Football Chat Room</h2>
        <div class="d-flex">
            <div class="chat-room">
                <ul id="messages"></ul>
                <input id="message" autocomplete="off" placeholder="Type a message...">
                <emoji-picker></emoji-picker><!-- Added emoji picker element -->
                <button onclick="sendMessage()">Send</button>
                <!-- Error message placeholder -->
                <div id="error-message"></div>
            </div>
            <div id="online-users">
                <h3>Online Users</h3>
                <ul id="user-list"></ul>
            </div>
        </div>   
    </div>
</main>

<!-- Socket.IO JavaScript -->
<script src="https://cdn.socket.io/4.0.0/socket.io.min.js" crossorigin="anonymous" nonce="{{ g.nonce }}"></script>
<!-- Emoji Picker JavaScript -->
<script type="module" nonce="{{ g.nonce }}">
    import 'https://unpkg.com/emoji-picker-element';
    
    const picker = document.querySelector('emoji-picker');
    const input = document.getElementById('message');

    picker.addEventListener('emoji-click', event => {
        input.value += event.detail.unicode;
    });
</script>

<script type="text/javascript" nonce="{{ g.nonce }}">
    var socket = io.connect('http://127.0.0.1:5000/football');

    socket.on('connect', function() {
        socket.emit('join');
    });

    socket.on('message', function(data) {
        var li = document.createElement('li');
        li.appendChild(document.createTextNode(data));
        document.getElementById('messages').appendChild(li);
    });

    function sendMessage() {
        var messageInput = document.getElementById('message');
        var message = messageInput.value.trim();  
        var errorMessageElement = document.getElementById('error-message');

        if (message === '') {
            errorMessageElement.textContent = 'Message cannot be empty';  
            return;
        }

        errorMessageElement.textContent = '';  
        socket.emit('message', message);
        messageInput.value = '';
    }

  
        socket.on('message', function(data) {
            var li = document.createElement('li');
            li.appendChild(document.createTextNode(data));
            var messages = document.getElementById('messages');
            messages.appendChild(li);
    
            // Auto-scroll to the bottom
            messages.scrollTop = messages.scrollHeight;
        });
    
       
    


</script>

{% endblock %}











